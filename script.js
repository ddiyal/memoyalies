function initializeVisitorCounter(){let e=document.getElementById("total-visitors-display"),t=document.getElementById("Stats1_totalCount");if(!e||!t){console.log("Elemen statistik tidak ditemukan.");return}let n=()=>{let n=t.textContent;if(n&&""!==n.trim()){let l=parseInt(n.replace(/[,.]/g,""),10);isNaN(l)?e.textContent=n:e.textContent=l.toLocaleString("id-ID")}},l=new MutationObserver(()=>{n()});l.observe(t,{childList:!0,characterData:!0,subtree:!0}),n()}function showRelatedPosts(e){let t=document.getElementById("related-posts-container");if(!t)return;let n="",l=window.location.href,i=0;if(!e.feed.entry){let s=t.closest(".widget");s&&(s.style.display="none");return}for(let a=0;a<e.feed.entry.length&&!(i>=5);a++){let r=e.feed.entry[a],d=r.link.find(e=>"alternate"===e.rel)?.href;if(!d||d===l)continue;let o=r.title.$t,c=new Date(r.published.$t).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),m="media$thumbnail"in r?r.media$thumbnail.url.replace("/s72-c/","/s100-c/"):"https://placehold.co/60x60/E0E0E0/A0A0A0?text=N/A";n+=`
           <div class='related-post-item'>
               <a href='${d}'>
                   <img class='related-post-thumbnail' loading='lazy' src='${m}'/>
                   <div class='related-post-info'>
                       <h4 class='related-post-title'>${o}</h4>
                       <span class='related-post-date'>${c}</span>
                   </div>
               </a>
           </div>`,i++}if(""!==n)t.innerHTML=n;else{let g=t.closest(".widget");g&&(g.style.display="none")}}document.addEventListener("DOMContentLoaded",function(){let e=document.body,t=document.getElementById("menuToggle"),n=document.getElementById("slideMenu"),l=document.getElementById("overlayMobile");if(t&&n&&l){let i=()=>{n.classList.toggle("open"),l.classList.toggle("active"),e.classList.toggle("no-scroll-mobile")};t.addEventListener("click",i),l.addEventListener("click",i)}let s=document.getElementById("currentYearSidebar");function a(){let e=new Date,t=document.getElementById("statusBarTime"),n=document.getElementById("statusBarDate");if(t){let l=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0");t.textContent=`${l}:${i}`}n&&(window.innerWidth>=768?(n.textContent=e.toLocaleDateString("id-ID",{weekday:"short",month:"short",day:"numeric"}),n.style.display="inline"):n.style.display="none")}s&&(s.textContent=new Date().getFullYear());let r=document.getElementById("backToTopBtn"),d=document.querySelector(".ios-main-content"),o=window.innerWidth<1024?window:d;function c(){!function e(){let t=document.getElementById("progressBar");if(!t)return;let n=window.innerWidth<1024?document.documentElement:d;if(!n)return;let l=n.scrollTop,i=n.scrollHeight-n.clientHeight;t.style.width=Math.min(100,Math.max(0,i>0?l/i*100:0))+"%"}();let e=window.innerWidth<1024?document.documentElement:d;r&&e&&(r.style.display=e.scrollTop>200?"flex":"none")}function m(){o&&o.scrollTo({top:0,behavior:"smooth"})}function g(){let e=document.querySelector(".main-layout-wrapper");if(window.innerWidth<1024||!e||!r){r&&(r.style.right="20px");return}let t=e.getBoundingClientRect(),n=document.documentElement.clientWidth-t.right+20;r.style.right=`${n}px`}let y=document.getElementById("theme-toggle"),h=window.matchMedia("(prefers-color-scheme: dark)");function u(e){document.body.classList.toggle("dark-mode","dark"===e)}let f=localStorage.getItem("theme");function p(e,t){if(!e||!t)return;let n;e.addEventListener("keyup",e=>{let l=e.target.value.trim();if(clearTimeout(n),l.length<3){t.style.display="none",t.innerHTML="";return}t.style.display="block",t.innerHTML='<div class="search-loader">Mencari...</div>',n=setTimeout(()=>{fetch(`/feeds/posts/default?alt=json&q=${encodeURIComponent(l)}&max-results=5`).then(e=>e.json()).then(e=>{let n="";e.feed.entry&&e.feed.entry.length>0?(n+="<ul>",e.feed.entry.forEach(e=>{let t=e.title.$t,l=(e.link.find(e=>"alternate"===e.rel)||{}).href;l&&(n+=`<li><a href="${l}">${t}</a></li>`)}),n+="</ul>"):n='<div class="no-results">Tidak ada hasil ditemukan.</div>',t.innerHTML=n}).catch(e=>{console.error("Error fetching search results:",e),t.innerHTML='<div class="no-results">Gagal memuat hasil.</div>'})},300)})}if(u(f||(h.matches?"dark":"light")),y.addEventListener("click",()=>{let e=document.body.classList.contains("dark-mode")?"light":"dark";localStorage.setItem("theme",e),u(e)}),h.addEventListener("change",e=>{localStorage.getItem("theme")||u(e.matches?"dark":"light")}),initializeVisitorCounter(),a(),setInterval(a,6e4),function e(){let t=window.location.href,n=document.title.split(" - ")[0],l=document.getElementById("social-whatsapp"),i=document.getElementById("social-twitter"),s=document.getElementById("social-facebook"),a=document.getElementById("social-telegram");if(l){let r=new URL("https://api.whatsapp.com/send");r.searchParams.set("text",n+" "+t),l.href=r.toString()}if(i){let d=new URL("https://twitter.com/intent/tweet");d.searchParams.set("text",n),d.searchParams.set("url",t),i.href=d.toString()}if(s){let o=new URL("https://www.facebook.com/sharer/sharer.php");o.searchParams.set("u",t),s.href=o.toString()}if(a){let c=new URL("https://t.me/share/url");c.searchParams.set("url",t),c.searchParams.set("text",n),a.href=c.toString()}}(),function t(){if(window.innerWidth>=1024)return;let i=document.getElementById("mobileBottomNav");i.style.display="flex",!e.classList.contains("index-page")||e.classList.contains("label-page")||e.classList.contains("search-results-page")||document.getElementById("nav-home").classList.add("active");let s=document.getElementById("nav-categories"),a=document.getElementById("categoriesModalOverlay"),r=document.getElementById("categoriesModalBody"),d=document.querySelector(".widget.Label .widget-content");s&&a&&d&&(r.innerHTML=d.innerHTML,s.addEventListener("click",()=>a.classList.add("active")),a.addEventListener("click",e=>{e.target===a&&a.classList.remove("active")}));let o=document.getElementById("nav-search"),c=document.getElementById("searchOverlayMobile"),m=document.getElementById("closeSearchOverlayBtn"),g=c.querySelector(".search-form-container"),y=document.querySelector(".sidebar-search-form");if(o&&c&&g&&y){g.appendChild(y);let h=g.querySelector(".sidebar-search-input"),u=g.querySelector("#live-search-results");p(h,u),o.addEventListener("click",()=>{c.classList.add("active"),h.focus()}),m.addEventListener("click",()=>c.classList.remove("active"))}let f=document.getElementById("nav-menu");f&&n&&l&&f.addEventListener("click",()=>{n.classList.add("open"),l.classList.add("active"),e.classList.add("no-scroll-mobile")})}(),g(),window.innerWidth>=1024){let E=document.querySelector(".sidebar-search-input"),v=document.querySelector("#live-search-results");p(E,v),d&&d.addEventListener("scroll",c)}else window.addEventListener("scroll",c);r&&r.addEventListener("click",m),document.getElementById("statusBarTime").addEventListener("click",m),window.addEventListener("resize",()=>{a(),g()}),c()}),document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("togglePopularBtn"),t=document.getElementById("popularPostsOverlay"),n=document.getElementById("closePopularBtn");e&&t&&n&&(e.addEventListener("click",function(){t.style.display="flex"}),n.addEventListener("click",function(){t.style.display="none"}),t.addEventListener("click",function(e){e.target===t&&(t.style.display="none")}));let l=document.getElementById("toggleCommentsBtn"),i=document.getElementById("commentsOverlay"),s=document.getElementById("closeCommentsBtn");l&&i&&s&&(l.addEventListener("click",function(){i.style.display="flex"}),s.addEventListener("click",function(){i.style.display="none"}),i.addEventListener("click",function(e){e.target===i&&(i.style.display="none")}))});
